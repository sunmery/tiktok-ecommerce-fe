import {
  require_react
} from "./chunk-5K37UKBQ.js";
import {
  __commonJS
} from "./chunk-H7J5LBHK.js";

// node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/message.js
var require_message = __commonJS({
  "node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/message.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
  }
});

// node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/AuthCallback.js
var require_AuthCallback = __commonJS({
  "node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/AuthCallback.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.AuthCallback = void 0;
    var React = require_react();
    var AuthCallback = class extends React.Component {
      constructor() {
        super(...arguments);
        this.signin = () => {
          const { sdk, serverUrl, isGetTokenSuccessful, saveTokenFromResponse } = this.props;
          sdk.signin(serverUrl).then((res) => {
            if (isGetTokenSuccessful(res)) {
              if (window !== window.parent) {
                this.sendSuccessfulLoginMessage();
              }
              if (saveTokenFromResponse) {
                saveTokenFromResponse(res);
              }
            } else {
              if (window !== window.parent) {
                this.sendLoginFailureMessage();
              }
            }
          });
        };
        this.sendSuccessfulLoginMessage = () => {
          const message = {
            tag: "Casdoor",
            type: "SilentSignin",
            data: "success"
          };
          window.parent.postMessage(message, "*");
        };
        this.sendLoginFailureMessage = () => {
          const message = {
            tag: "Casdoor",
            type: "SilentSignin",
            data: "login-failure"
          };
          window.parent.postMessage(message, "*");
        };
      }
      UNSAFE_componentWillMount() {
        this.signin();
      }
      render() {
        return React.createElement(React.Fragment, null);
      }
    };
    exports.AuthCallback = AuthCallback;
  }
});

// node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/SilentSignin.js
var require_SilentSignin = __commonJS({
  "node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/SilentSignin.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    exports.isSilentSigninRequired = exports.SilentSignin = void 0;
    var React = require_react();
    var SilentSignin = class extends React.Component {
      constructor() {
        super(...arguments);
        this.listenForSilentSigninEvents = () => {
          const { handleReceivedSilentSigninSuccessEvent, handleReceivedSilentSigninFailureEvent } = this.props;
          window.addEventListener("message", (event) => {
            const message = event.data;
            if (message.tag !== "Casdoor" || message.type !== "SilentSignin") {
              return;
            }
            if (message.data === "success") {
              if (handleReceivedSilentSigninSuccessEvent) {
                handleReceivedSilentSigninSuccessEvent(message);
              }
            } else {
              if (handleReceivedSilentSigninFailureEvent) {
                handleReceivedSilentSigninFailureEvent(message);
              }
            }
          });
        };
      }
      componentDidMount() {
        this.listenForSilentSigninEvents();
      }
      render() {
        const { isLoggedIn, sdk } = this.props;
        if (window !== window.parent) {
          return null;
        }
        if (isLoggedIn()) {
          return null;
        }
        return React.createElement("iframe", { id: "iframeTask", src: `${sdk.getSigninUrl()}&silentSignin=1`, style: { display: "none" }, frameBorder: "no" });
      }
    };
    exports.SilentSignin = SilentSignin;
    function isSilentSigninRequired() {
      const params = new URLSearchParams(window.location.search);
      return params.get("silentSignin") === "1";
    }
    exports.isSilentSigninRequired = isSilentSigninRequired;
  }
});

// node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/index.js
var require_lib = __commonJS({
  "node_modules/.pnpm/casdoor-react-sdk@1.2.0/node_modules/casdoor-react-sdk/lib/index.js"(exports) {
    var __createBinding = exports && exports.__createBinding || (Object.create ? function(o, m, k, k2) {
      if (k2 === void 0) k2 = k;
      var desc = Object.getOwnPropertyDescriptor(m, k);
      if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
        desc = { enumerable: true, get: function() {
          return m[k];
        } };
      }
      Object.defineProperty(o, k2, desc);
    } : function(o, m, k, k2) {
      if (k2 === void 0) k2 = k;
      o[k2] = m[k];
    });
    var __exportStar = exports && exports.__exportStar || function(m, exports2) {
      for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(exports2, p)) __createBinding(exports2, m, p);
    };
    Object.defineProperty(exports, "__esModule", { value: true });
    __exportStar(require_message(), exports);
    __exportStar(require_AuthCallback(), exports);
    __exportStar(require_SilentSignin(), exports);
  }
});
export default require_lib();
//# sourceMappingURL=casdoor-react-sdk.js.map
