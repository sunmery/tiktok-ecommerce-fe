import{r as S,U as c}from"./index-eJYtR5xA.js";var p={},f={};Object.defineProperty(f,"__esModule",{value:!0});var u={};Object.defineProperty(u,"__esModule",{value:!0});u.AuthCallback=void 0;const d=S;class w extends d.Component{constructor(){super(...arguments),this.signin=()=>{const{sdk:i,serverUrl:t,isGetTokenSuccessful:s,saveTokenFromResponse:e}=this.props;i.signin(t).then(n=>{s(n)?(window!==window.parent&&this.sendSuccessfulLoginMessage(),e&&e(n)):window!==window.parent&&this.sendLoginFailureMessage()})},this.sendSuccessfulLoginMessage=()=>{const i={tag:"Casdoor",type:"SilentSignin",data:"success"};window.parent.postMessage(i,"*")},this.sendLoginFailureMessage=()=>{const i={tag:"Casdoor",type:"SilentSignin",data:"login-failure"};window.parent.postMessage(i,"*")}}UNSAFE_componentWillMount(){this.signin()}render(){return d.createElement(d.Fragment,null)}}u.AuthCallback=w;var l={};Object.defineProperty(l,"__esModule",{value:!0});l.isSilentSigninRequired=l.SilentSignin=void 0;const g=S;class m extends g.Component{constructor(){super(...arguments),this.listenForSilentSigninEvents=()=>{const{handleReceivedSilentSigninSuccessEvent:i,handleReceivedSilentSigninFailureEvent:t}=this.props;window.addEventListener("message",s=>{const e=s.data;e.tag!=="Casdoor"||e.type!=="SilentSignin"||(e.data==="success"?i&&i(e):t&&t(e))})}}componentDidMount(){this.listenForSilentSigninEvents()}render(){const{isLoggedIn:i,sdk:t}=this.props;return window!==window.parent||i()?null:g.createElement("iframe",{id:"iframeTask",src:`${t.getSigninUrl()}&silentSignin=1`,style:{display:"none"},frameBorder:"no"})}}l.SilentSignin=m;function v(){return new URLSearchParams(window.location.search).get("silentSignin")==="1"}l.isSilentSigninRequired=v;(function(r){var i=c&&c.__createBinding||(Object.create?function(s,e,n,a){a===void 0&&(a=n);var o=Object.getOwnPropertyDescriptor(e,n);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(s,a,o)}:function(s,e,n,a){a===void 0&&(a=n),s[a]=e[n]}),t=c&&c.__exportStar||function(s,e){for(var n in s)n!=="default"&&!Object.prototype.hasOwnProperty.call(e,n)&&i(e,s,n)};Object.defineProperty(r,"__esModule",{value:!0}),t(f,r),t(u,r),t(l,r)})(p);export{p as l};
